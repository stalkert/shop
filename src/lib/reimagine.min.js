"use strict";function randomColor(){function t(o){var n=Math.round(Math.random()*o);return e==n?t(o):e=n,e}document.querySelectorAll(".mc").forEach(function(e){e.classList.add("material-color_background_"+t(82))});var e=0}function Context(){function t(){function t(t){return t<d.left+c?d.left+c:t>d.right-u.width-c?d.right-u.width-c:t}function o(t){return t<d.top+c?d.top+c:t>d.bottom-u.height-c?d.bottom-u.height-c:t}if(e){var i=getElementParams(e),u=getElementParams(r),d={left:0,right:document.body.clientWidth,top:document.body.scrollTop,bottom:document.body.scrollTop+document.body.clientHeight};e.closest(".workspace")&&(i.top-=document.querySelector(".workspace").scrollTop,i.bottom-=document.querySelector(".workspace").scrollTop),i.top-=document.body.scrollTop,i.bottom-=document.body.scrollTop;for(var a in n)if(Math.abs(d[a]-i[a])>u[n[a]]){if(l.setAttribute("direction",a),"bottom"==a){var s=t(i.left+i.width/2-u.width/2);r.style.top=i.bottom+c+"px",r.style.left=s+"px",l.style.left=i.left-s+i.width/2+"px"}if("top"==a){var s=t(i.left+i.width/2-u.width/2);r.style.top=i.top-u.height-c+"px",r.style.left=s+"px",l.style.left=i.left-s+i.width/2+"px"}if("right"==a){var f=o(i.top+i.height/2-u.height/2);r.style.top=f+"px",r.style.left=i.right+c+"px",l.style.top=i.top-f+i.height/2+"px"}if("left"==a){var f=o(i.top+i.height/2-u.height/2);r.style.top=f+"px",r.style.left=i.left-u.width-c+"px",l.style.top=i.top-f+i.height/2+"px"}return}}}var e=null,o=null,n={bottom:"height",top:"height",right:"width",left:"width"},r=document.getElementById("context"),i=r.querySelector(".context__body"),l=r.querySelector(".context__arrow"),c=10,u=function(){document.querySelectorAll("*[oncontext]").forEach(function(t){t.getAttribute("oncontext")&&document.querySelectorAll("."+t.getAttribute("oncontext")).forEach(function(t){t.oncontextmenu=function(t){return e=this,a(),disableScroll(document.querySelector(".workspace")),stop(t),!1}})}),document.querySelectorAll("*[context]").forEach(function(t){t.onclick=function(){e=this,a()}}),window.addEventListener("click",function(t){var t=t||window.event,e=t.target||t.srcElement;e.closest("#context, *[context]")||s()}),document.addEventListener("contextmenu",function(t){var t=t||window.event,e=t.target||t.srcElement;e.closest("#context, *[oncontext]")||s()})},d=function(){document.oncontextmenu=function(t){return stop(t),!1}},a=function(){if(s(),!e.hasAttribute("disable")){e.setAttribute("active","");var l=e.querySelector("context");if(l||(l=e.parentNode.querySelector("context")),l){var c=e.getAttribute("context");n="right"==c?{right:"width",left:"width",top:"height",bottom:"height"}:"left"==c?{left:"width",right:"width",top:"height",bottom:"height"}:"top"==c?{top:"height",bottom:"height",right:"width",left:"width"}:{bottom:"height",top:"height",right:"width",left:"width"};var u=l.innerHTML;i.innerHTML=parseHTML(u),r.style.display="block",t(),o=e,modal.init()}}},s=function(){enableScroll(document.querySelector(".workspace")),r.style.display="none",i.innerHTML=parseHTML(""),o&&o.removeAttribute("active")};this.init=u,this.disable=d,this.open=a,this.close=s}function getElementParams(t){if("string"==typeof t&&(t=document.querySelector(t)),t){var e=0,o=0,n=t.clientWidth,r=t.clientHeight;for(getComputedStyle(t);t;)e+=parseInt(t.offsetTop),o+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:o,bottom:e+r,right:o+n,width:n,height:r}}}function Selection(){var t=function(){document.querySelectorAll("*[selection]").forEach(function(t){var o=t.getAttribute("selection");o&&t.querySelectorAll("."+o).forEach(function(t){t.onmousedown=function(){e(t)},t.oncontext=function(){e(t)}})}),window.addEventListener("click",function(t){var e=e||window.event,n=e.target||e.srcElement;n.closest("*[selected]")||o()})},e=function(t){o(),t.setAttribute("selected","")},o=function(){document.querySelectorAll("*[selected]").forEach(function(t){t.removeAttribute("selected")})};this.init=t}function Modal(){var t=function(){document.querySelectorAll(".modal__close").forEach(function(t){t.onclick=function(){o()}}),document.querySelectorAll("*[modal]").forEach(function(t){var o=t.getAttribute("modal");o&&(t.onclick=function(){e(o)})}),document.addEventListener("click",function(t){var e=t||window.event;e.target.closest(".modal, #context")||o()}),document.addEventListener("contextmenu",function(t){var e=t||window.event;e.target.closest(".modal, #context")||o()})},e=function(t){var e=document.getElementById(t);e&&e.setAttribute("open","")},o=function(t){var e=document.querySelector(".modal[open]");e&&e.removeAttribute("open")};this.init=t,this.open=e,this.close=o}function preventDefault(t){t=t||window.event,t.preventDefault&&t.preventDefault(),t.returnValue=!1}function preventDefaultForScrollKeys(t){if(keys[t.keyCode])return preventDefault(t),!1}function disableScroll(t){t.addEventListener&&t.addEventListener("DOMMouseScroll",preventDefault,!1),t.onwheel=preventDefault,t.onmousewheel=document.onmousewheel=preventDefault,t.ontouchmove=preventDefault,document.onkeydown=preventDefaultForScrollKeys}function enableScroll(t){t&&(t.removeEventListener&&t.removeEventListener("DOMMouseScroll",preventDefault,!1),t.onmousewheel=document.onmousewheel=null,t.onwheel=null,t.ontouchmove=null,t.onkeydown=null)}var modal=null;window.addEventListener("load",function(){randomColor();var t=new Context;t.init(),t.disable(),modal=new Modal,modal.init()});var keys={37:1,38:1,39:1,40:1};